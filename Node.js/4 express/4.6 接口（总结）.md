### Node.js 4.6 接口 （总结前面知识）

1. **创建接口步骤（总结之前课程）**

   1.  创建基本的服务器: app.js

      ```javascript
      const express = require('express')
      const app = express()
      //main code
      app.listen(80, function(){
          console.log('Express server running at http://127.0.0.1')
      })
      ```

      

   2. 创建 API 路由模块

      apiRouter.js 路由模块

      ```javascript
      const express = require('express')
      const apiRouter = express.Router()
      //main code
      module.exports = apiRouter
      ```

      app.js 导入注册路由模块

      ```javascript
      const apiRouter = require('./apiRouter.js')
      app.use('/api', apiRouter)
      ```

      

2. **编写 GET 接口**

   ```javascript
   apiRouter.get('/get', (req, res) => {
       const query = req.query     //req.query可访问查询字符串形式发到服务器的参数,详见4.1.8。
       res.send({
           status:0,  //0成功，1失败
           msg:'GET requst succeed',
           data:query
       })
   })
   ```

   

3. **编写 POST 接口**

   ```javascript
   apiRouter.post('/post', (req, res) => { //获取客户端通过请求体，发送到服务器的URL-encoded数据
       const body = req.body     //req.body对象，可访问请求体数据,详见4.5.5。
       res.send({
           status:0,  //0成功，1失败
           msg:'POST requst succeed',
           data:body
       })
   })
   ```

   注意：如果要获取 URL-encoded 格式的请求体数据，必须配置中间件：
   
   ```javascript
   app.use(express.urlencoded( {extended:false} ))
   ```
   
   

4. **接口的跨域问题**

   上面的 GET/POST 接口是不支持跨域请求的。（表现为 postman 可以请求成功，但是 html 网页中的请求无法成功。）

   见下一节。
   
   